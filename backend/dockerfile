FROM tiangolo/uvicorn-gunicorn-fastapi:python3.7

ARG MYSQL_HOST
ARG MYSQL_USER
ARG MYSQL_PASSWORD
ARG MYSQL_DB
ARG MYSQL_CHARSET
ARG CRAWL_ENDPOINT

ENV MYSQL_HOST ${MYSQL_HOST}
ENV MYSQL_USER ${MYSQL_USER}
ENV MYSQL_PASSWORD ${MYSQL_PASSWORD}
ENV MYSQL_DB ${MYSQL_DB}
ENV MYSQL_CHARSET ${MYSQL_CHARSET}
ENV CRAWL_ENDPOINT ${CRAWL_ENDPOINT}

COPY ./app /app
WORKDIR /app

RUN pip install -r requirements.txt
RUN pip install git+https://github.com/jungin500/py-hanspell

ENV PORT=8080
ENV TIMEOUT=180
ENV GRACEFUL_TIMEOUT=180
ENV MAX_WORKERS=1
ENV WORKERS_PER_CORE=2